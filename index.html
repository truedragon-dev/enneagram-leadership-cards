<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-5VFNX8QJB3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-5VFNX8QJB3');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enneagram Leadership Cards</title>
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#764ba2">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Leadership Cards">
    <link rel="apple-touch-icon" href="icon-192.png">
    <link rel="apple-touch-icon" sizes="192x192" href="icon-192.png">

    <!-- PWA Service Worker Registration -->
    <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/enneagram-leadership-cards/sw.js')
          .then((registration) => {
            console.log('SW registered: ', registration);
          })
          .catch((registrationError) => {
            console.log('SW registration failed: ', registrationError);
          });
      });
    }

    // PWA Install Prompt
    let deferredPrompt;
    const installButton = document.createElement('button');
    installButton.style.cssText = `
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #764ba2;
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 25px;
      font-size: 14px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      z-index: 1000;
      display: none;
    `;
    installButton.textContent = '📱 Install App';
    document.body.appendChild(installButton);

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      installButton.style.display = 'block';
    });

    installButton.addEventListener('click', () => {
      installButton.style.display = 'none';
      deferredPrompt.prompt();
      deferredPrompt.userChoice.then((choiceResult) => {
        if (choiceResult.outcome === 'accepted') {
          console.log('User accepted the install prompt');
        }
        deferredPrompt = null;
      });
    });

    window.addEventListener('appinstalled', () => {
      console.log('PWA was installed');
      installButton.style.display = 'none';
    });
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            background: #667eea;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
            background-attachment: fixed;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            will-change: transform;
            transform: translateZ(0)
        }

        /* Navigation Styles */
        .navigation {
            position: sticky;
            top: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 0;
            margin: -40px -40px 30px -40px;
            border-radius: 20px 20px 0 0;
            z-index: 100;
            border-bottom: 1px solid rgba(102, 126, 234, 0.2);
        }

        .nav-buttons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 8px;
            padding: 0 20px;
        }

        .nav-button {
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        /* Type-specific navigation button colors */
        .nav-button[data-type="1"] { background: #e76f51; }
        .nav-button[data-type="2"] { background: #4a9b4a; }
        .nav-button[data-type="3"] { background: #2d6a4f; }
        .nav-button[data-type="4"] { background: #4a9b8e; }
        .nav-button[data-type="5"] { background: #1e6091; }
        .nav-button[data-type="6"] { background: #6a4c93; }
        .nav-button[data-type="7"] { background: #457b9d; }
        .nav-button[data-type="8"] { background: #a63446; }
        .nav-button[data-type="9"] { background: #b8956a; }

        .nav-button.experiment {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: #764ba2;
            padding: 8px 12px;
        }

        .nav-button.experiment:hover {
            background: linear-gradient(135deg, #9f7aea 0%, #553c9a 100%);
            color: white;
            border-color: transparent;
        }

        h1 {
            text-align: center;
            font-size: 2.5em;
            color: #4a5568;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .subtitle {
            text-align: center;
            font-size: 1.2em;
            color: #718096;
            margin-bottom: 20px;
            font-style: italic;
        }

        .instructions {
            text-align: center;
            font-size: 1em;
            color: #4a5568;
            margin-bottom: 30px;
            padding: 15px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 10px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        .card-container {
            perspective: 1000px;
            height: 950px;
            scroll-margin-top: 120px;
        }
/* Focus highlight animation */
.card-container.focused {
    animation: cardFocus 1.2s ease-out;
}

@keyframes cardFocus {
    0% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(102, 126, 234, 0);
    }
    40% {
        transform: scale(1.01);
        box-shadow: 0 0 0 15px rgba(102, 126, 234, 0.15);
    }
    100% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(102, 126, 234, 0);
    }
}
        .card {
            position: relative;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform 0.8s ease;
            cursor: pointer;
        }

        .card.flipped {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
            background: white;
            border-left: 6px solid;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .card-back {
            transform: rotateY(180deg);
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
        }

        .type-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .type-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-right: 15px;
            opacity: 0.8;
        }

        .type-name {
            font-size: 1.4em;
            font-weight: 600;
            color: #2d3748;
        }

        .section {
            margin-bottom: 15px;
        }

        .section-title {
            font-size: 0.9em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
            opacity: 0.7;
        }

        .section-content {
            line-height: 1.5;
            font-size: 0.9em;
        }

        .field-question {
            background: rgba(102, 126, 234, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid;
            font-size: 1em;
            line-height: 1.6;
        }

        .field-title {
            font-size: 1.8em;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 20px;
            text-align: center;
        }

        .attribution {
            margin-top: auto;
            margin-bottom: 40px;
            font-size: 0.75em;
            color: #9ca3af;
            font-style: italic;
        }

        .flip-indicator {
            position: absolute;
            bottom: 15px;
            right: 15px;
            font-size: 0.8em;
            color: #718096;
            background: rgba(255, 255, 255, 0.8);
            padding: 5px 10px;
            border-radius: 15px;
        }

        .core-drive { color: #e53e3e; }
        .leads-through { color: #38a169; }
        .interaction-style { color: #3182ce; }
        .shadow-watch { color: #d69e2e; }
        .growth-edge { color: #805ad5; }

        .experiment-card {
            border-left-color: #9f7aea !important;
            background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%) !important;
        }

        .experiment-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            justify-content: center;
        }

        .experiment-icon {
            font-size: 2.5em;
            margin-right: 15px;
        }

        .experiment-title {
            font-size: 1.6em;
            font-weight: 600;
            color: #553c9a;
        }

        .experiment-content {
            margin-bottom: 20px;
        }

        .current-experiment {
            background: rgba(159, 122, 234, 0.1);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            border-left: 4px solid #9f7aea;
        }

        .experiment-label {
            font-size: 0.9em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #553c9a;
            margin-bottom: 10px;
        }

        .experiment-practice {
            font-size: 1.1em;
            line-height: 1.5;
            color: #2d3748;
            font-weight: 500;
        }

        .experiment-instructions {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .instruction-step {
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .step-number {
            background: #9f7aea;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9em;
            font-weight: 600;
            flex-shrink: 0;
        }

        .step-text {
            font-size: 0.95em;
            line-height: 1.4;
            color: #4a5568;
        }

        .experiment-examples {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .example-card {
            background: rgba(159, 122, 234, 0.1);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #9f7aea;
        }

        .example-type {
            font-size: 0.9em;
            font-weight: 600;
            color: #553c9a;
            margin-bottom: 8px;
        }

        .example-text {
            font-size: 0.9em;
            line-height: 1.5;
            color: #2d3748;
        }

        /* Type-specific colors */
        .type-1 { border-left-color: #e76f51; }
        .type-2 { border-left-color: #4a9b4a; }
        .type-3 { border-left-color: #2d6a4f; }
        .type-4 { border-left-color: #4a9b8e; }
        .type-5 { border-left-color: #1e6091; }
        .type-6 { border-left-color: #6a4c93; }
        .type-7 { border-left-color: #457b9d; }
        .type-8 { border-left-color: #a63446; }
        .type-9 { border-left-color: #b8956a; }

        .type-1 .type-number { color: #e76f51; }
        .type-2 .type-number { color: #4a9b4a; }
        .type-3 .type-number { color: #2d6a4f; }
        .type-4 .type-number { color: #4a9b8e; }
        .type-5 .type-number { color: #1e6091; }
        .type-6 .type-number { color: #6a4c93; }
        .type-7 .type-number { color: #457b9d; }
        .type-8 .type-number { color: #a63446; }
        .type-9 .type-number { color: #b8956a; }

        .type-1 .field-question { border-left-color: #e76f51; }
        .type-2 .field-question { border-left-color: #4a9b4a; }
        .type-3 .field-question { border-left-color: #2d6a4f; }
        .type-4 .field-question { border-left-color: #4a9b8e; }
        .type-5 .field-question { border-left-color: #1e6091; }
        .type-6 .field-question { border-left-color: #6a4c93; }
        .type-7 .field-question { border-left-color: #457b9d; }
        .type-8 .field-question { border-left-color: #a63446; }
        .type-9 .field-question { border-left-color: #b8956a; }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            .navigation {
                margin: -20px -20px 20px -20px;
            }
            
            .nav-buttons {
                gap: 6px;
                padding: 0 10px;
            }
            
            .nav-button {
                padding: 8px 12px;
                font-size: 13px;
            }
            
            .nav-button.experiment {
                padding: 8px 10px;
            }
            
            .grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .card-container {
                height: 850px;
                scroll-margin-top: 80px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Navigation Header -->
        <div class="navigation">
           <div class="nav-buttons">
    <button class="nav-button" data-type="1" onclick="event.stopPropagation(); scrollToCard(1)">1</button>
    <button class="nav-button" data-type="2" onclick="event.stopPropagation(); scrollToCard(2)">2</button>
    <button class="nav-button" data-type="3" onclick="event.stopPropagation(); scrollToCard(3)">3</button>
    <button class="nav-button" data-type="4" onclick="event.stopPropagation(); scrollToCard(4)">4</button>
    <button class="nav-button" data-type="5" onclick="event.stopPropagation(); scrollToCard(5)">5</button>
    <button class="nav-button" data-type="6" onclick="event.stopPropagation(); scrollToCard(6)">6</button>
    <button class="nav-button" data-type="7" onclick="event.stopPropagation(); scrollToCard(7)">7</button>
    <button class="nav-button" data-type="8" onclick="event.stopPropagation(); scrollToCard(8)">8</button>
    <button class="nav-button" data-type="9" onclick="event.stopPropagation(); scrollToCard(9)">9</button>
    <button class="nav-button experiment" onclick="event.stopPropagation(); scrollToCard('experiment')">⚡</button>
</div>
        </div>

        <h1>Enneagram Leadership Cards</h1>
        <p class="subtitle">Individual Awareness & Higher Team IQ</p>
        <div class="instructions">
            <strong>Click any card to flip between individual patterns and team intelligence questions.</strong><br>
            Use the team intelligence side to elevate your collective thinking in real time.
        </div>

        <div class="grid" id="cardGrid">
            <!-- Cards will be populated by JavaScript -->
        </div>
    </div>

    <script>
        // Simple, smooth navigation function
function scrollToCard(cardNumber) {
    console.log('scrollToCard called with:', cardNumber); // Debug log
    
    const cardElement = document.querySelector(`[data-card="${cardNumber}"]`);
    console.log('Found card element:', cardElement); // Debug log
    
    if (!cardElement) {
        console.error('Card element not found for:', cardNumber);
        return;
    }
    
    // Prevent multiple simultaneous scroll operations
    if (window.isScrolling) {
        console.log('Already scrolling, ignoring request');
        return;
    }
    
    window.isScrolling = true;
    
    // Remove any existing focus
    document.querySelectorAll('.card-container').forEach(card => {
        card.classList.remove('focused');
    });
    
    // Detect mobile/touch devices
    const isMobile = window.innerWidth <= 768 || 'ontouchstart' in window;
    
    if (isMobile) {
        // Use browser smooth scroll on mobile (it's optimized)
        cardElement.scrollIntoView({ 
            behavior: 'smooth', 
            block: 'start' 
        });
        
        setTimeout(() => {
            cardElement.classList.add('focused');
            window.isScrolling = false; // Reset flag
        }, 800);
    } else {
        // Use custom scroll on desktop to avoid white flash
        const targetPosition = cardElement.offsetTop - 120;
        const startPosition = window.pageYOffset;
        const distance = targetPosition - startPosition;
        const duration = Math.min(Math.abs(distance) * 0.4, 800);
        
        console.log('Scroll details:', { targetPosition, startPosition, distance, duration }); // Debug log
        
        let start = null;
        
        function smoothScrollStep(timestamp) {
            if (!start) start = timestamp;
            const progress = Math.min((timestamp - start) / duration, 1);
            
            // Smoother easing
            const ease = progress * (2 - progress);
            const currentPosition = startPosition + (distance * ease);
            
            window.scrollTo(0, currentPosition);
            
            if (progress < 1) {
                requestAnimationFrame(smoothScrollStep);
            } else {
                setTimeout(() => {
                    cardElement.classList.add('focused');
                    window.isScrolling = false; // Reset flag
                }, 100);
            }
        }
        
        requestAnimationFrame(smoothScrollStep);
        }
    }
}
        const enneagramData = [
            {
                type: "Type 1—The Strict Perfectionist",
                number: "1",
                coreDrive: "Driven to do what's right and improve the world while avoiding mistakes, blame, or being seen as corrupt or defective.",
                leadsThrough: "Integrity, responsibility, attention to detail, organization, and pragmatism",
                interactionStyle: "Principled, firm, composed. Leads with structure and standards. Can become rigid under chaos or inefficiency.",
                shadowWatch: "When I'm in shadow, I can create a field where others feel like they're walking on eggshells, anticipating criticism and judgment. This happens even when I think I'm being helpful by pointing out what needs to be fixed.",
                growthEdge: "Act on what's good enough before you know it's right, and stay with it long enough to discover that effectiveness can emerge from iteration, not just perfection.",
                fieldQuestions: [
                    "What's working well that we should protect and build on?",
                    "Where is perfectionism blocking our progress?",
                    "What standards are serving us vs. limiting us right now?",
                    "Are we focusing on being right or being effective?"
                ]
            },
            {
                type: "Type 2—The Considerate Helper",
                number: "2",
                coreDrive: "Seeks love and connection by meeting others' needs while avoiding rejection, being seen as inadequate, or feeling unneeded.",
                leadsThrough: "Motivation, relationships, supportiveness, and resourcefulness",
                interactionStyle: "Warm, attentive, relationally attuned. Prioritizes others' needs and rapport. May over-accommodate or avoid direct asks.",
                shadowWatch: "When I'm in shadow, I can make others feel guilty for having needs I can't meet or for not appreciating my efforts enough. This happens even when I think I'm being selflessly supportive.",
                growthEdge: "Ask directly for what you need before ensuring others are taken care of, and stay with it long enough to discover that others can stay connected even when you prioritize yourself.",
                fieldQuestions: [
                    "Who's not being heard or cared for right now?",
                    "What does the emotional field need from us?",
                    "Are we attending to relationships while pursuing our goals?",
                    "Who might be giving too much and needs support?"
                ]
            },
            {
                type: "Type 3—The Competitive Achiever",
                number: "3",
                coreDrive: "Pursues achievement and recognition to feel valued while avoiding failure, inefficiency, or being seen as unsuccessful or unworthy.",
                leadsThrough: "Focus, clear goals, entrepreneurial spirit, and can-do energy",
                interactionStyle: "Polished, focused, efficient. Orients to goals and recognition. Can bypass emotional nuance in pursuit of performance.",
                shadowWatch: "When I'm in shadow, I can create a pace that others can't sustain and make process feel less important than results. This happens even when I think I'm being appropriately focused and efficient.",
                growthEdge: "Show up authentically messy before you feel polished enough, and stay with it long enough to discover that people can value your realness more than your performance.",
                fieldQuestions: [
                    "Are we optimizing for real impact or just looking successful?",
                    "What's the right pace for sustainable progress?",
                    "Are we including all voices in our drive toward goals?",
                    "What are we sacrificing in our pursuit of achievement?"
                ]
            },
            {
                type: "Type 4—The Intense Creative",
                number: "4",
                coreDrive: "Strives for authenticity and emotional depth while avoiding being misunderstood, mundane, or emotionally insignificant.",
                leadsThrough: "Vision, creativity, compassion, and emotional depth",
                interactionStyle: "Expressive, introspective, emotionally honest. Seeks depth and resonance. May withdraw if authenticity feels threatened.",
                shadowWatch: "When I'm in shadow, I can create a field where others feel they can't be authentic enough or that their concerns are too ordinary. This happens even when I think I'm championing depth and meaning.",
                growthEdge: "Share what's ordinary and commonplace about your experience, and stay with it long enough to discover that connection can happen through shared humanity, not just specialness.",
                fieldQuestions: [
                    "What's missing from our conversation that needs to be named?",
                    "Are we being authentic or just going through the motions?",
                    "What deeper purpose are we serving beyond the task?",
                    "Who might be feeling unseen or misunderstood?"
                ]
            },
            {
                type: "Type 5—The Quiet Specialist",
                number: "5",
                coreDrive: "Seeks knowledge and clarity to maintain autonomy while avoiding intrusion, overwhelm, or appearing incompetent.",
                leadsThrough: "Expertise, analysis, objectivity, planning, and logic",
                interactionStyle: "Private, precise, observing. Engages from a distance. Shares selectively and prefers mental clarity over emotional messiness.",
                shadowWatch: "When I'm in shadow, I can withhold information and process, leaving others to fill in gaps with assumptions. This happens even when I think I'm being thorough and protecting the quality of my thinking.",
                growthEdge: "Share your thinking process before it's complete, and stay with it long enough to discover that others' input can enhance rather than contaminate your insights.",
                fieldQuestions: [
                    "What information is the team missing that I might have?",
                    "Are we making decisions with enough data and analysis?",
                    "What am I observing that others might not be seeing?",
                    "Where do we need more time to think before acting?"
                ]
            },
            {
                type: "Type 6—The Loyal Skeptic",
                number: "6",
                coreDrive: "Wants security and trust through loyalty and vigilance while avoiding uncertainty, blame, or being caught off guard.",
                leadsThrough: "Risk assessment, perseverance, collaboration, and foresight",
                interactionStyle: "Vigilant, loyal, questioning. Builds safety through inquiry and preparedness. Can oscillate between caution and pushback.",
                shadowWatch: "When I'm in shadow, I can create an atmosphere where others feel questioned, doubted, or that nothing is ever safe enough. This happens even when I think I'm being appropriately cautious and thorough.",
                growthEdge: "Act on your instinct before you have all the guarantees, and stay with it long enough to discover that security can come from trusting your inner knowing, not just external certainty.",
                fieldQuestions: [
                    "What risks are we not seeing or preparing for?",
                    "Do we have enough support and backup plans?",
                    "Who's not fully committed and why?",
                    "Are we moving too fast without considering consequences?"
                ]
            },
            {
                type: "Type 7—The Enthusiastic Visionary",
                number: "7",
                coreDrive: "Pursues freedom, joy, and new possibilities while avoiding limitation, pain, or feeling trapped in discomfort.",
                leadsThrough: "Innovation, curiosity, energy, idea generation, and optimism",
                interactionStyle: "Upbeat, scattered, future-focused. Brings energy and ideas. May avoid hard emotions or prematurely pivot from discomfort.",
                shadowWatch: "When I'm in shadow, I can create a field where difficult emotions or problems get dismissed or glossed over too quickly. This happens even when I think I'm maintaining positive energy and forward momentum.",
                growthEdge: "Stay with difficulty and constraint long enough to let it teach you, and discover that depth can emerge from limitation, not just from endless options.",
                fieldQuestions: [
                    "What possibilities are we not seeing or exploring?",
                    "Are we avoiding something difficult that needs attention?",
                    "Is our energy sustainable or are we burning out?",
                    "What would inject more innovation or creativity here?"
                ]
            },
            {
                type: "Type 8—The Active Controller",
                number: "8",
                coreDrive: "Driven to assert control and protect what matters while avoiding vulnerability, weakness, or being controlled by others.",
                leadsThrough: "Boldness, action, strategic influence, and candor",
                interactionStyle: "Bold, direct, intense. Commands attention and moves quickly to action. Can overpower or challenge before building buy-in.",
                shadowWatch: "When I'm in shadow, I can create a field where others feel steamrolled, unheard, or afraid to voice alternative perspectives. This happens even when I think I'm being appropriately direct and action-oriented.",
                growthEdge: "Show your uncertainty and ask for help before you feel strong enough, and stay with it long enough to discover that vulnerability can increase rather than diminish your influence.",
                fieldQuestions: [
                    "What are we avoiding that needs direct engagement?",
                    "Where is power not flowing effectively in our team?",
                    "Who might be holding back their truth or perspective?",
                    "Are we moving with appropriate force or overwhelming others?"
                ]
            },
            {
                type: "Type 9—The Adaptive Peacemaker",
                number: "9",
                coreDrive: "Seeks peace, harmony, and internal stability while avoiding conflict, tension, or the discomfort of their own priorities.",
                leadsThrough: "Patience, consistency, diplomacy, and inclusion",
                interactionStyle: "Open, agreeable, unhurried. Tends to merge with group flow. May resist direct conflict or suppress inner priorities.",
                shadowWatch: "When I'm in shadow, I can create a vacuum where others have to carry all the tension and make the difficult decisions. This happens even when I think I'm being diplomatic and keeping the peace.",
                growthEdge: "Speak into the conflict that others are avoiding and stay with it long enough to discover that engaging tension can create deeper harmony than always avoiding it.",
                fieldQuestions: [
                    "What tensions are we not addressing that need attention?",
                    "Whose perspectives are missing from our conversation?",
                    "Are we including everyone or just avoiding conflict?",
                    "What would bring more genuine harmony vs. surface peace?"
                ]
            }
        ];

        function createCard(data) {
    return `
        <div class="card-container" data-card="${data.number}">
            <div class="card type-${data.number}" onclick="flipCard(this)">
                <div class="card-face type-${data.number}">
                    <div class="type-header">
                        <div class="type-number">${data.number}</div>
                        <div class="type-name">${data.type.replace(/Type \d+—/, '')}</div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title core-drive">Core Drive</div>
                        <div class="section-content">${data.coreDrive}</div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title leads-through">Leads Through</div>
                        <div class="section-content">${data.leadsThrough}</div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title interaction-style">Interaction Style</div>
                        <div class="section-content">${data.interactionStyle}</div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title shadow-watch">Shadow Watch</div>
                        <div class="section-content">${data.shadowWatch}</div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title growth-edge">Growth Edge</div>
                        <div class="section-content">${data.growthEdge}</div>
                    </div>
                    
                    <div class="attribution">
                        created by allan @ truedragon.io
                    </div>
                    
                    <div class="flip-indicator">Click to flip →</div>
                </div>
                
                <div class="card-face card-back type-${data.number}">
                    <div class="type-header">
                        <div class="type-number">${data.number}</div>
                        <div class="type-name">${data.type.replace(/Type \d+—/, '')}</div>
                    </div>
                    
                    <div class="field-title">Questions for Higher Team IQ</div>
                    
                    ${data.fieldQuestions.map(question => 
                        `<div class="field-question">${question}</div>`
                    ).join('')}
                    
                    <div class="flip-indicator">← Click to flip back</div>
                </div>
            </div>
        </div>
    `;
}

        function flipCard(card) {
            card.classList.toggle('flipped');
        }

        function renderCards() {
            const grid = document.getElementById('cardGrid');
            const typeCards = enneagramData.map(createCard).join('');
            
            // Add experiment card at the end
            const experimentCard = `
                <div class="card-container" data-card="experiment">
                    <div class="card experiment-card" onclick="flipCard(this)">
                        <div class="card-face experiment-card">
                            <div class="experiment-header">
                                <div class="experiment-icon">⚡</div>
                                <div class="experiment-title">Weekly Team Experiment</div>
                            </div>
                            
                            <div class="experiment-content">
                                <div class="current-experiment">
                                    <div class="experiment-label">This Week's Focus:</div>
                                    <div class="experiment-practice" id="currentExperiment">
                                        Choose a growth edge from someone present and practice it together as a team this week.
                                    </div>
                                </div>
                                
                                <div class="experiment-instructions">
                                    <div class="instruction-step">
                                        <span class="step-number">1.</span>
                                        <span class="step-text">Pick one person's growth edge from the cards</span>
                                    </div>
                                    <div class="instruction-step">
                                        <span class="step-number">2.</span>
                                        <span class="step-text">Adapt it for team practice this week</span>
                                    </div>
                                    <div class="instruction-step">
                                        <span class="step-number">3.</span>
                                        <span class="step-text">Check in Friday: What did we discover?</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="attribution">
                                created by allan @ truedragon.io
                            </div>
                            
                            <div class="flip-indicator">Click to see examples →</div>
                        </div>
                        
                        <div class="card-face card-back experiment-card">
                            <div class="experiment-header">
                                <div class="experiment-icon">💡</div>
                                <div class="experiment-title">Example Team Experiments</div>
                            </div>
                            
                            <div class="experiment-examples">
                                <div class="example-card">
                                    <div class="example-type">Type 7 Growth Edge</div>
                                    <div class="example-text">"This week: Stay with one difficult conversation until it reaches resolution. Don't pivot or find creative ways around the constraint."</div>
                                </div>
                                
                                <div class="example-card">
                                    <div class="example-type">Type 3 Growth Edge</div>
                                    <div class="example-text">"This week: Prioritize authenticity over looking successful. Share what's messy or imperfect instead of waiting until we look polished."</div>
                                </div>
                                
                                <div class="example-card">
                                    <div class="example-type">Type 8 Growth Edge</div>
                                    <div class="example-text">"This week: Share uncertainties and ask for help before we feel strong enough. Practice saying 'We don't know' and 'We need support.'"</div>
                                </div>
                            </div>
                            
                            <div class="flip-indicator">← Click to flip back</div>
                        </div>
                    </div>
                </div>
            `;
            
            grid.innerHTML = typeCards + experimentCard;
        }

        // Initialize cards
        renderCards();

        // Analytics tracking setup
        let cardSession = {
          startTime: Date.now(),
          totalFlips: 0,
          individualViews: 0,
          teamViews: 0,
          typesViewed: new Set(),
          lastFlipTime: Date.now()
        };

        let viewedCards = new Set();
        let cardEngagementTimes = new Map();
        let currentlyViewedCards = new Map();
        let viewObserver;
        let inactivityTimer;

        function trackCardFlip(enneagramType, newSide) {
          cardSession.totalFlips++;
          cardSession.typesViewed.add(enneagramType);
          cardSession.lastFlipTime = Date.now();
          
          if (newSide === 'individual') {
            cardSession.individualViews++;
          } else if (newSide === 'team') {
            cardSession.teamViews++;
          }
          
          gtag('event', 'card_flip', {
            'event_category': 'card_interaction',
            'event_label': `type_${enneagramType}_to_${newSide}`,
            'enneagram_type': enneagramType,
            'side_shown': newSide,
            'total_flips': cardSession.totalFlips,
            'session_duration': Math.round((Date.now() - cardSession.startTime) / 1000)
          });
          
          gtag('event', `type_${enneagramType}_flip_to_${newSide}`, {
            'event_category': 'specific_flips',
            'enneagram_type': enneagramType,
            'side_shown': newSide
          });
          
          gtag('event', 'type_viewed', {
            'event_category': 'card_interaction',
            'event_label': `type_${enneagramType}`,
            'custom_parameter_1': enneagramType,
            'unique_types_in_session': cardSession.typesViewed.size
          });
          
          gtag('event', `type_${enneagramType}_viewed`, {
            'event_category': 'type_popularity',
            'enneagram_type': enneagramType,
            'side_shown': newSide
          });
        }

        function trackCardView(card) {
          const typeMatch = card.className.match(/type-(\d+)/);
          const enneagramType = typeMatch ? typeMatch[1] : 'experiment';
          
          currentlyViewedCards.set(enneagramType, Date.now());
          
          if (!viewedCards.has(enneagramType)) {
            viewedCards.add(enneagramType);
            
            gtag('event', 'card_viewed', {
              'event_category': 'card_exposure',
              'event_label': `type_${enneagramType}_viewed`,
              'enneagram_type': enneagramType,
              'side_shown': 'individual',
              'view_method': 'scroll'
            });
            
            gtag('event', `type_${enneagramType}_viewed_scroll`, {
              'event_category': 'card_exposure',
              'enneagram_type': enneagramType
            });
          }
        }

        function trackCardExit(card) {
          const typeMatch = card.className.match(/type-(\d+)/);
          const enneagramType = typeMatch ? typeMatch[1] : 'experiment';
          
          if (currentlyViewedCards.has(enneagramType)) {
            const startTime = currentlyViewedCards.get(enneagramType);
            const timeSpent = Math.round((Date.now() - startTime) / 1000);
            
            if (timeSpent >= 2) {
              const existingTime = cardEngagementTimes.get(enneagramType) || 0;
              cardEngagementTimes.set(enneagramType, existingTime + timeSpent);
              
              gtag('event', 'card_engagement_time', {
                'event_category': 'card_engagement',
                'event_label': `type_${enneagramType}_${timeSpent}s`,
                'enneagram_type': enneagramType,
                'engagement_seconds': timeSpent,
                'total_card_time': cardEngagementTimes.get(enneagramType)
              });
              
              let timeBucket;
              if (timeSpent < 10) timeBucket = 'quick_scan';
              else if (timeSpent < 30) timeBucket = 'moderate_read';
              else if (timeSpent < 60) timeBucket = 'deep_read';
              else timeBucket = 'extended_study';
              
              gtag('event', `type_${enneagramType}_${timeBucket}`, {
                'event_category': 'engagement_depth',
                'engagement_seconds': timeSpent,
                'time_bucket': timeBucket
              });
            }
            
            currentlyViewedCards.delete(enneagramType);
          }
        }

        function trackSessionSummary() {
          const sessionDuration = Math.round((cardSession.lastFlipTime - cardSession.startTime) / 1000);
          const preferredSide = cardSession.individualViews > cardSession.teamViews ? 'individual' : 'team';
          
          gtag('event', 'session_summary', {
            'session_duration': sessionDuration,
            'total_flips': cardSession.totalFlips,
            'unique_types': cardSession.typesViewed.size,
            'preferred_side': preferredSide,
            'individual_views': cardSession.individualViews,
            'team_views': cardSession.teamViews
          });
        }

        function setupViewTracking() {
          if ('IntersectionObserver' in window) {
            viewObserver = new IntersectionObserver((entries) => {
              entries.forEach(entry => {
                if (entry.isIntersecting && entry.intersectionRatio > 0.5) {
                  trackCardView(entry.target);
                } else if (!entry.isIntersecting && currentlyViewedCards.has(entry.target.className.match(/type-(\d+)/)?.[1] || 'experiment')) {
                  trackCardExit(entry.target);
                }
              });
            }, {
              threshold: [0, 0.5]
            });
            
            document.querySelectorAll('.card').forEach(card => {
              viewObserver.observe(card);
            });
          }
        }

        function resetInactivityTimer() {
          clearTimeout(inactivityTimer);
          inactivityTimer = setTimeout(trackSessionSummary, 30000);
        }

        // Event listeners
        window.addEventListener('beforeunload', function() {
          currentlyViewedCards.forEach((startTime, enneagramType) => {
            const timeSpent = Math.round((Date.now() - startTime) / 1000);
            if (timeSpent >= 2) {
              const existingTime = cardEngagementTimes.get(enneagramType) || 0;
              cardEngagementTimes.set(enneagramType, existingTime + timeSpent);
              
              gtag('event', 'final_card_engagement', {
                'event_category': 'session_end',
                'enneagram_type': enneagramType,
                'engagement_seconds': timeSpent,
                'total_card_time': cardEngagementTimes.get(enneagramType)
              });
            }
          });
          
          trackSessionSummary();
        });

        document.addEventListener('click', resetInactivityTimer);
        document.addEventListener('keypress', resetInactivityTimer);

        document.addEventListener('click', function(e) {
          const card = e.target.closest('.card');
          
          if (card) {
            const typeMatch = card.className.match(/type-(\d+)/);
            const enneagramType = typeMatch ? typeMatch[1] : 'experiment';
            
            setTimeout(() => {
              const isShowingTeam = card.classList.contains('flipped');
              const currentSide = isShowingTeam ? 'team' : 'individual';
              
              trackCardFlip(enneagramType, currentSide);
              resetInactivityTimer();
            }, 50);
          }
        });

        // Initial page load tracking
        gtag('event', 'page_load', {
          'page_title': document.title,
          'page_location': window.location.href
        });

        // Initialize view tracking after cards are rendered
        setTimeout(setupViewTracking, 1000);
    </script>
</body>
</html> 
